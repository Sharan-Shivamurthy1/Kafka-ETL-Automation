SC_B_3NF_DD_DIM_PRODUCT_OFFERING:SELECT A.PRODUCT_OFFERING_ID, A.PRODUCT_OFFERING_NAME, A.PRODUCT_OFFERING_DESC, A.PRODUCT_OFFERING_START_DATE, A.PRODUCT_OFFERING_END_DATE, D.OFFERING_SUBCATEGORY_NAME AS OFFERING_CLASSIFICATION_NAME, CASE WHEN B.OFFERING_CATEGORY_NAME='Devices' THEN 'Device Offer' WHEN B.OFFERING_CATEGORY_NAME='SIM-Only' THEN 'SIM-Only' ELSE 'Not Applicable' END AS SIMO_DEVICE_OFFER_FLAG, CASE WHEN E.OFFERING_TYPE_NAME='MBB Plan' THEN 'MBB Plan' WHEN E.OFFERING_TYPE_NAME='Voice Offer' THEN 'Voice Offer' ELSE 'Not Applicable' END AS VOICE_MBB_OFFER_FLAG, E.OFFERING_TYPE_NAME, B.OFFERING_CATEGORY_NAME AS PRODUCT_OFFERING_CATEGORY_NAME, D.OFFERING_SUBCATEGORY_NAME AS OFFERING_SUB_CATEGORY_NAME, CASE WHEN G.PARAMETER_NAME='CH_CONTRACT_DURATION' THEN G.ALLOWED_VALUE END AS OFFERING_DURATION, CASE WHEN G.PARAMETER_NAME='CFS_SMS' THEN G.DEFAULT_VALUE END AS CFS_SMS_FLAG, CASE WHEN N.PRODPRICE_ALLOWANCE_NAME='SMS' THEN N.SPENDING_TOTAL END AS SMS_ALLOWANCE, CASE WHEN P.PRODPRICE_CHARGE_NAME='SMS' THEN P.AMOUNT END AS SMS_UNIT_PRICE, CASE WHEN G.PARAMETER_NAME='CFS_MMS' THEN G.DEFAULT_VALUE END AS CFS_MMS_FLAG, CASE WHEN N.PRODPRICE_ALLOWANCE_NAME='MMS' THEN N.SPENDING_TOTAL END AS MMS_ALLOWANCE, CASE WHEN P.PRODPRICE_CHARGE_NAME='MMS' THEN P.AMOUNT END AS MMS_UNIT_PRICE, CASE WHEN G.PARAMETER_NAME='CFS_MDATA' THEN G.DEFAULT_VALUE END AS CFS_DATA_FLAG, CASE WHEN N.PRODPRICE_ALLOWANCE_NAME='Mobile Data' THEN N.SPENDING_TOTAL END AS DATA_ALLOWANCE, CASE WHEN P.PRODPRICE_CHARGE_NAME='Mobile Data' THEN P.AMOUNT END AS DATA_UNIT_PRICE, CASE WHEN G.PARAMETER_NAME='CFS_MVOICE' THEN G.DEFAULT_VALUE END AS CFS_VOICE_FLAG, CASE WHEN N.PRODPRICE_ALLOWANCE_NAME='Mobile Voice' THEN N.SPENDING_TOTAL END AS LOCAL_VOICE_ALLOWANCE, CASE WHEN P.PRODPRICE_CHARGE_NAME='Mobile Voice' THEN P.AMOUNT END AS LOCAL_VOICE_UNIT_PRICE, CASE WHEN N.PRODPRICE_ALLOWANCE_NAME='International' THEN N.SPENDING_TOTAL END AS INTL_VOICE_ALLOWANCE, CASE WHEN P.PRODPRICE_CHARGE_NAME='International' THEN P.AMOUNT END AS INTL_VOICE_UNIT_PRICE FROM PRODUCT_OFFERING A LEFT JOIN OFFERING_CATEGORY_SUBCATEGORY C ON A.PRODUCT_OFFERING_ID = C.PRODUCT_OFFERING_ID AND  A.RECORD_STATUS = '1' AND C.RECORD_STATUS = '1' LEFT JOIN OFFERING_SUBCATEGORY D ON C.OFFERING_SUBCATEGORY_ID = D.OFFERING_SUBCATEGORY_ID AND D.OFFERING_SUBCATEGORY_NAME IN ('Prepaid','Postpaid') LEFT JOIN SUB_OFFERING Y ON A.PRODUCT_OFFERING_ID = Y.PRODUCT_OFFERING_ID AND Y.RECORD_STATUS = '1' LEFT JOIN (SELECT COUNT(A1.OFFERING_CATEGORY_ID),A1.OFFERING_CATEGORY_ID FROM PRODUCT_OFFERING A1 LEFT JOIN SUB_OFFERING A2 ON A2.PRODUCT_OFFERING_ID = A1.PRODUCT_OFFERING_ID LEFT JOIN PRODUCT_OFFERING A3 ON A3.PRODUCT_OFFERING_ID = A2.SUB_PRODUCT_OFFERING_ID LEFT JOIN OFFERING_CATEGORY A4 ON A4.OFFERING_CATEGORY_ID = A3.OFFERING_CATEGORY_ID AND A4.OFFERING_CATEGORY_NAME = 'Devices' GROUP BY A1.OFFERING_CATEGORY_ID )Z ON Z.OFFERING_CATEGORY_ID = A.OFFERING_CATEGORY_ID LEFT JOIN (SELECT COUNT(B1.OFFERING_CATEGORY_ID),B1.OFFERING_CATEGORY_ID FROM PRODUCT_OFFERING B1 LEFT JOIN SUB_OFFERING B2 ON B2.PRODUCT_OFFERING_ID = B1.PRODUCT_OFFERING_ID LEFT JOIN PRODUCT_OFFERING B3 ON B3.PRODUCT_OFFERING_ID = B2.SUB_PRODUCT_OFFERING_ID LEFT JOIN OFFERING_CATEGORY B4 ON B4.OFFERING_CATEGORY_ID = B3.OFFERING_CATEGORY_ID AND B4.OFFERING_CATEGORY_NAME = 'Accesories' GROUP BY B1.OFFERING_CATEGORY_ID )Q ON Q.OFFERING_CATEGORY_ID = A.OFFERING_CATEGORY_ID LEFT JOIN OFFERING_TYPE E ON E.OFFERING_TYPE_ID = (SELECT DISTINCT(A.OFFERING_TYPE_ID) FROM PRODUCT_OFFERING) LEFT JOIN OFFERING_CATEGORY B ON B.OFFERING_CATEGORY_ID=(SELECT DISTINCT(A.OFFERING_CATEGORY_ID) FROM PRODUCT_OFFERING) LEFT JOIN OFFERING_ACCOUNT_TYPE V ON V.OFFERING_ACCOUNT_TYPE_ID = A.OFFERING_ACCOUNT_TYPE_ID LEFT JOIN OFFERING_PAYMENT_TYPE W ON W.OFFERING_PAYMENT_TYPE_ID = A.OFFERING_PAYMENT_TYPE_ID LEFT JOIN OFFERING_PRICEPLAN X ON X.PRODUCT_OFFERING_ID=A.PRODUCT_OFFERING_ID AND X.RECORD_STATUS = '1' LEFT JOIN PRODUCT_OFFERING_PARAM F ON F.PRODUCT_OFFERING_ID = A.PRODUCT_OFFERING_ID AND F.RECORD_STATUS = '1' LEFT JOIN PARAMETER G ON G.PARAMETER_ID = F.PARAMETER_ID AND G.PARAMETER_NAME IN ('CH_CONTRACT_DURATION','REBUSCFS_MVOICE','REBUSCFS_MD_VOICE','REBUSCFS_VOICEMAIL') AND G.RECORD_STATUS = '1' LEFT JOIN PRODUCT_SPECIFICATION H ON H.PRODUCT_SPEC_ID = A.PRODUCT_SPEC_ID AND H.RECORD_STATUS = '1' LEFT JOIN PRODUCT_CFS I ON I.PRODUCT_SPEC_ID = H.PRODUCT_SPEC_ID AND I.RECORD_STATUS = '1' LEFT JOIN CFS_SPECIFICATION J ON J.CFS_SPECIFICATION_ID = I.CFS_SPECIFICATION_ID AND J.RECORD_STATUS = '1' LEFT JOIN CFS_PARAM K ON K.PARAMETER_ID = J.CFS_SPECIFICATION_ID AND K.RECORD_STATUS = '1' LEFT JOIN OFFERING_PRICEPLAN L ON L.PRODUCT_OFFERING_ID = A.PRODUCT_OFFERING_ID LEFT JOIN PRICEPLAN_ALLOWANCE M ON M.PRODUCT_OFFER_PRICE_ID = L.PRODUCT_OFFER_PRICE_ID AND M.RECORD_STATUS = '1' LEFT JOIN PRICEPLAN_CHARGE O ON O.PRODUCT_OFFER_PRICE_ID = L.PRODUCT_OFFER_PRICE_ID AND O.RECORD_STATUS = '1' LEFT JOIN PRODPRICE_ALLOWANCE N ON N.PRODPRICE_ALLOWANCE_ID = M.PRODPRICE_ALLOWANCE_ID AND N.PRODPRICE_ALLOWANCE_NAME='SMS' AND N.RECORD_STATUS = '1' LEFT JOIN PRODPRICE_CHARGE P ON P.PRODPRICE_CHARGE_ID = O.PRODPRICE_CHARGE_ID AND P.RECORD_STATUS = '1':target query:null query
SC_B_3NF_DD_DIM_CHANNEL:SELECT CHANNEL_ID,CHANNEL_NAME FROM DW_3NF.CHANNEL where update_job_run_id>=$MIN_RUN_ID_CURRENT and update_job_run_id<=$MAX_RUN_ID_CURRENT:select CHANNEL_ID,CHANNEL_NAME from DW_DD.DIM_CHANNEL WHERE CREATE_JOB_RUN_ID=$job_run_id:select CHANNEL_ID,CHANNEL_NAME,CHANNEL_TYPE_NAME,CREATE_JOB_RUN_ID,UPDATE_JOB_RUN_ID,CREATE_DATE_TIME,UPDATE_DATE_TIME,CREATE_USER_ID,UPDATE_USER_ID from DIM_CHANNEL where CHANNEL_ID is null or CHANNEL_NAME is null or CHANNEL_TYPE_NAME is null or CREATE_JOB_RUN_ID is null or UPDATE_JOB_RUN_ID is null or CREATE_DATE_TIME is null or UPDATE_DATE_TIME is null or CREATE_USER_ID is null or UPDATE_USER_ID is null
